# 예제 문제

1. SAL의 평균보다 많이 받는 사람들의 이름과 SAL을 출력하시오.

   SELECT ENAME, SAL FROM EMP
   WHERE SAL > (SELECT AVG(SAL) FROM EMP)

   

2. 그 중에서 DALLAS나 CHICAGO에서 근무하는 사람들의 이름을 출력하시오.

   SELECT ENAME, SAL FROM EMP
   WHERE SAL > (SELECT AVG(SAL) FROM EMP)
   AND (
   DEPTNO IN  //  **!! 여러개를 리턴하는 경우에는 IN을 사용해서 가져와야 함 !!**
   (SELECT DEPTNO FROM DEPT WHERE LOC IN ('DALLAS', 'CHICAGO')))

   

3. 부서 별 월급의 평균을 구하고자 한다. 이중 전체 평균보다 높은 부서만 출력한다. 단, NEW YORK 부서는 제외한다.

   1) SELECT DEPTNO, AVG(SAL) FROM EMP
   GROUP BY DEPTNO
   HAVING AVG(SAL)>(SELECT AVG(SAL) FROM EMP)
   AND DEPTNO **!=** (SELECT DEPTNO FROM DEPT WHERE LOC ='NEW YORK')

   

   2) SELECT DEPTNO, AVG(SAL) FROM EMP
   GROUP BY DEPTNO
   HAVING AVG(SAL)>(SELECT AVG(SAL) FROM EMP)
   AND DEPTNO **NOT IN** (SELECT DEPTNO FROM DEPT WHERE LOC ='NEW YORK')

   

4. JOB 별 평균 월급 보다 많이 받는 사람(JOB, ENAME, SAL)을 조회하시오.

   SELECT JOB, ENAME, SAL FROM EMP E1
   WHERE SAL >
   (SELECT AVG(SAL) FROM EMP E2
   <u>WHERE E1.JOB = E2.JOB</u> // !! 여기가 중요 !!
   GROUP BY JOB)

   

5.  부서 별로 가장 월급을 많이 받는 사람의 DEPTNO, ENAME, SAL을 조회하시오.

   SELECT DEPTNO, ENAME, SAL FROM EMP A
   WHERE SAL>=
   (SELECT MAX(SAL) FROM EMP B
   WHERE A.DEPTNO = B.DEPTNO
   GROUP BY DEPTNO)

   

6.  부서 별로 가장 월급을 많이 받는 사람의 DEPTNO, ENAME, SAL을 조회하시오. 단, 부서명 ACCOUNTING은 제외하시오.

   SELECT DEPTNO, ENAME, SAL FROM EMP A
   WHERE SAL>=
   (SELECT MAX(SAL) FROM EMP B
   WHERE A.DEPTNO = B.DEPTNO
   AND DEPTNO NOT IN (SELECT DEPTNO FROM DEPT WHERE DNAME='ACCOUNTING')
   GROUP BY DEPTNO)

   

7. SCOTT이 소속된 부서의 매니저들의 EMPNO, ENAME, DEPTNO를 조회하시오.

   1) SELECT EMPNO, ENAME, DEPTNO FROM EMP 
   WHERE EMPNO IN (
   SELECT MGR FROM EMP
   WHERE DEPTNO =
   (SELECT DEPTNO FROM EMP WHERE ENAME = 'SCOTT'))

   

   2) SELECT EMPNO, ENAME, DEPTNO FROM EMP E1
   WHERE EMPNO IN (
   SELECT MGR FROM EMP E2
   WHERE DEPTNO =
   (SELECT DEPTNO FROM EMP WHERE ENAME = 'SCOTT')
   AND E1.EMPNO=E2.MGR)



8. EMP를 조회한다. EMPNO, ENAME, DNAME, LOC

   SELECT e.EMPNO, e.ENAME, d.DNAME, d.LOC FROM EMP e, DEPT d
   WHERE e.DEPTNO = d.DEPTNO

   

9. 지역 별 월급의 평균을 구하시오.

   SELECT AVG(E.SAL), D.LOC FROM EMP E, DEPT D
   WHERE E.DEPTNO = D.DEPTNO
   GROUP BY D.LOC

   

10. 지역 별 월급을 평균보다 많이 받는 사람의 LOC, ENAME, SAL을 조회하시오. 단, DALLAS는 제외하시오.

    SELECT D.LOC, E.ENAME, E.SAL FROM EMP E, DEPT D
    WHERE E.DEPTNO = D.DEPTNO
    AND D.LOC NOT IN ('DALLAS')
    AND E.SAL> 
    (SELECT AVG(SAL) FROM EMP E2, DEPT D2
    WHERE E2.DEPTNO = D2.DEPTNO
    AND D.LOC = D2.LOC
     GROUP BY D.LOC)



11. 지역 별 입사 일이 가장 늦은 사원의 정보를 출력하시오. (LOC, ENAME, HIREDATE)

    SELECT D.LOC, E.ENAME, E.HIREDATE FROM EMP E, DEPT D
    WHERE E.DEPTNO = D.DEPTNO
    AND E.HIREDATE>=
    (SELECT MAX(HIREDATE) FROM EMP E2
    WHERE E.DEPTNO = E2.DEPTNO
    GROUP BY D.LOC)

