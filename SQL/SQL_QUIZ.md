```sql
SQL 퀴즈

--우리조
SELECT 
ROUND((SYSDATE-HIREDATE)/365), 
TRUNC((SYSDATE-HIREDATE)/365),
MONTHS_BETWEEN(SYSDATE,HIREDATE),
(MONTHS_BETWEEN(SYSDATE,HIREDATE))/12 
FROM EMP
 
SELECT REPLACE(ENAME,
SUBSTR(ENAME,2,LENGTH(ENAME)), 
SUBSTR (LOWER(ENAME),2,LENGTH(ENAME))) AS RESULT
FROM EMP ORDER BY ENAME;


--3조 1번
SELECT ENAME, 
(SAL*0.78)*12 + (NVL(COMM,0)*0.88)*12 AS ANNSAL,
(TRUNC(((SAL*0.78)*12 + (NVL(COMM,0)*0.88)*12)/100))*100 AS "REAL ANNSAL",
CASE WHEN (SAL*0.78)*12 + (NVL(COMM,0)*0.88)*12>=30000
     THEN '부자'
     WHEN (SAL*0.78)*12 + (NVL(COMM,0)*0.88)*12>=20000 AND (SAL*0.78)*12 + (NVL(COMM,0)*0.88)*12<30000
     THEN '중산층'
     ELSE '평민'
END AS "연봉 분류"
FROM EMP
ORDER BY ANNSAL DESC;
 
 
--1조 1번
SELECT ENAME, JOB, HIREDATE, SYSDATE,
SAL*12 + (NVL(COMM,0)*12) AS ASAL,
CASE WHEN SAL*12 + (NVL(COMM,0)*12)>50000
     THEN TO_CHAR((SAL*12 + (NVL(COMM,0)*12))*0.5)
     WHEN SAL*12 + (NVL(COMM,0)*12)>35000 AND SAL*12 + (NVL(COMM,0)*12)<50000
     THEN TO_CHAR((SAL*12 + (NVL(COMM,0)*12))*0.7)
     ELSE TO_CHAR((SAL*12 + (NVL(COMM,0)*12))*0.8)
END AS "REAL ASAL",
(SAL + (NVL(COMM,0)))*TRUNC(MONTHS_BETWEEN(SYSDATE,HIREDATE)) AS TOTALMONEY 
FROM EMP
ORDER BY TOTALMONEY DESC
 

--1조 2번
SELECT DEPTNO, ENAME, JOB, HIREDATE, COMM FROM EMP
WHERE COMM IS NULL AND (ENAME LIKE '%I%' OR ENAME LIKE '%M%')
ORDER BY DEPTNO DESC

 
--6조 1번
SELECT ENAME, 
ROUND(SYSDATE-HIREDATE) AS WD,
SUBSTR (JOB,1,3) AS JOB,
SAL,
NVL(COMM,0)+200 AS NCOMM
FROM EMP


--6조 2번
SELECT 
REPLACE(ENAME,
SUBSTR(ENAME,2,LENGTH(ENAME)), 
SUBSTR (LOWER(ENAME),2,LENGTH(ENAME))) AS NAME,
CASE WHEN SAL>=3000
     THEN TO_CHAR((SAL*12)*0.7)
     ELSE TO_CHAR((SAL*12)*0.8)
END AS ASAL,
SAL+(NVL(COMM,0)) AS EARN,
SAL, COMM
FROM EMP
ORDER BY EARN DESC
 
 
--4조 1번
SELECT 
ENAME, JOB, HIREDATE,
TRUNC(SYSDATE-HIREDATE) AS DAYS,
CASE WHEN ROUND(SYSDATE-HIREDATE)>=14000
     THEN '부장'
     WHEN ROUND(SYSDATE-HIREDATE)>=13500 AND ROUND(SYSDATE-HIREDATE)<14000
     THEN '과장'
     ELSE '직원'
END AS "직급"
FROM EMP
WHERE JOB='CLERK'
ORDER BY DAYS DESC
 

--4조 2번
SELECT
SUBSTR(ENAME, 1, 3) AS NICKNAME,
JOB, HIREDATE, SAL,
TO_CHAR(HIREDATE,'MM')
FROM EMP
WHERE TO_CHAR(HIREDATE,'MM') IN (11,12)
ORDER BY SAL
 
 
--5조 1번
SELECT
ENAME, 
REPLACE(JOB, SUBSTR(JOB,2,LENGTH(JOB)), 
SUBSTR (LOWER(JOB),2,LENGTH(JOB))) AS JOB_L,
SAL,
TO_CHAR(HIREDATE,'YYYY-MM-DD') AS HD
FROM EMP
WHERE JOB LIKE '%ER' OR JOB LIKE '%ST'
WHERE ROUND(SYSDATE-HIREDATE)>13800


--5조 1번
SELECT
ENAME, 
REPLACE(JOB, SUBSTR(JOB,2,LENGTH(JOB)), 
SUBSTR (LOWER(JOB),2,LENGTH(JOB))) AS JOB_L,
SAL,
TO_CHAR(HIREDATE,'YYYY-MM-DD') AS HD
FROM EMP
WHERE JOB LIKE '%ER' OR JOB LIKE '%ST'
 

--5조 2번
SELECT 
ENAME, JOB, SAL, HIREDATE, TRUNC(SYSDATE-HIREDATE) AS "근무일",
CASE WHEN TRUNC(SYSDATE-HIREDATE)>=14000
     THEN '부장'
     WHEN ROUND(SYSDATE-HIREDATE)>=13700 AND ROUND(SYSDATE-HIREDATE)<14000
     THEN '과장'
     WHEN ROUND(SYSDATE-HIREDATE)>=13400 AND ROUND(SYSDATE-HIREDATE)<13700
     THEN '대리'
     ELSE '사원'
END AS "RANK"
FROM EMP
WHERE COMM IS NULL
ORDER BY TRUNC(SYSDATE-HIREDATE) DESC
 
 
--3조 2번
SELECT
ENAME, HIREDATE
FROM EMP
ORDER BY HIREDATE, ENAME
```

