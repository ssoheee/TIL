## 0603 SQL

```sql
SELECT TO_CHAR(HIREDATE, 'YYYY'), JOB, AVG(SAL) FROM EMP
WHERE DEPTNO IN (10,20)
GROUP BY TO_CHAR(HIREDATE, 'YYYY'), JOB
HAVING TO_CHAR(HIREDATE, 'YYYY') = 1981 AND AVG(SAL)>=1500
 
SELECT TO_CHAR(HIREDATE, 'MM') AS MONTH, AVG(SAL) FROM EMP
WHERE DEPTNO IN(20,30)
GROUP BY TO_CHAR(HIREDATE, 'MM')
HAVING TO_CHAR(HIREDATE, 'MM') IN(4,5,12)
 
 
SELECT JOB, TO_CHAR(HIREDATE, 'MM') AS MONTHS, MAX(SAL) AS MAX FROM EMP
WHERE ENAME LIKE '%S%'
GROUP BY JOB, TO_CHAR(HIREDATE, 'MM')
HAVING TO_CHAR(HIREDATE, 'MM') = 12
 
 
SELECT JOB, TO_CHAR(HIREDATE, 'MM') AS MM, AVG(SAL+(NVL(COMM,0))) AS MEAN FROM EMP
WHERE ENAME LIKE '%A%'
GROUP BY JOB, TO_CHAR(HIREDATE, 'MM')
HAVING AVG(SAL+(NVL(COMM,0))) >=2000
ORDER BY MEAN DESC
 
 
SELECT JOB, MGR, ENAME FROM EMP
WHERE TO_CHAR(HIREDATE, 'MM') IN (9,12) AND MGR=7698
ORDER BY JOB
 
SELECT MAX(A) AS MAX_SALARY, MIN(A) AS MIN_SALARY FROM 
(
SELECT JOB, AVG(SAL) AS A FROM EMP
GROUP BY JOB
HAVING AVG(SAL)>=2000
)
```